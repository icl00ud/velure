# Define o número de réplicas para o Deployment
replicaCount: 2

# Configuração da imagem do Docker
image:
  repository: icl00ud/velure-auth
  pullPolicy: Always
  tag: "latest"

# Segredos para repositórios privados (opcional, vazio para públicos)
imagePullSecrets: []

# Sobrescrever nomes padrão
nameOverride: ""
fullnameOverride: ""

# Configurações da conta de serviço
serviceAccount:
  create: true
  automount: true
  annotations: {}
  name: ""

# Anotações e rótulos personalizados para pods
podAnnotations: {}
podLabels: {}

# Contexto de segurança do Pod
podSecurityContext: {}
securityContext: {}

# Configurações do serviço (ClusterIP expõe o serviço internamente)
service:
  type: ClusterIP
  port: 3020

# Configuração de Ingress (desativado por enquanto)
ingress:
  enabled: true
  className: "alb"
  annotations:
    alb.ingress.kubernetes.io/group.name: velure-public
    alb.ingress.kubernetes.io/group.order: "10"
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/healthcheck-path: /health
    alb.ingress.kubernetes.io/healthcheck-interval-seconds: "15"
    alb.ingress.kubernetes.io/healthcheck-timeout-seconds: "5"
    alb.ingress.kubernetes.io/success-codes: "200"
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}]'
  hosts:
    - host: ""
      paths:
        - path: /api/auth
          pathType: Prefix
  tls: []

# Recursos de CPU e memória para o container
resources:
  limits:
    cpu: "100m"
    memory: "128Mi"
  requests:
    cpu: "100m"
    memory: "128Mi"

# Probes de liveness e readiness
livenessProbe:
  httpGet:
    path: /health
    port: http
readinessProbe:
  httpGet:
    path: /health
    port: http

# Configuração de autoscaling
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 65

# Volumes adicionais (se necessário)
volumes: []
volumeMounts: []

# Seletores e tolerâncias para nós
nodeSelector: {}
tolerations: []
affinity: {}

# Redis configuration
redis:
  host: "velure-datastores-redis-master.datastores.svc.cluster.local"
  port: "6379"
  secretName: "velure-auth-redis"

# Secrets configuration (use existing secrets or allow creating externally)
secrets:
  postgres:
    url: "postgresql://auth_user:auth_password@postgres.datastores.svc.cluster.local:5432/velure_auth?sslmode=disable"
  jwt:
    secret: "velure-jwt-secret-key-change-in-production"
    expiresIn: "24h"
    refreshSecret: "velure-refresh-secret-key-change-in-production"
    refreshExpiresIn: "168h"
  session:
    secret: "velure-session-secret-key-change-in-production"
    expiresIn: "24h"

# Prometheus metrics configuration
metrics:
  enabled: true
  serviceMonitor:
    enabled: true
    interval: 30s
    scrapeTimeout: 10s
    labels:
      prometheus: kube-prometheus
